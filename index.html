<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è‹±è¯­è·Ÿè¯»ç»ƒä¹ </title>
    <style>
        :root {
            --primary: #10B981;
            --primary-light: #A7F3D0;
            --success: #059669;
            --warning: #F59E0B;
            --error: #EF4444;
            --background: #F0FDF4;
            --surface: #FFFFFF;
            --text: #064E3B;
            --text-light: #6B7280;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--background);
            color: var(--text);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: var(--surface);
            border-radius: 20px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.06);
            overflow: hidden;
            min-height: 600px;
        }

        .header {
            background: linear-gradient(135deg, var(--primary) 0%, #059669 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            margin-bottom: 10px;
            font-size: 1.8em;
        }

        .progress-bar {
            height: 6px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 3px;
            margin: 20px 0;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: white;
            border-radius: 3px;
            transition: width 0.3s ease;
            width: 0%;
        }

        /* è§†é¢‘åº“æ ·å¼ */
        .video-library {
            padding: 20px;
        }

        .video-grid {
            display: grid;
            gap: 20px;
            margin-top: 20px;
        }

        .video-card {
            border: 2px solid #E2E8F0;
            border-radius: 15px;
            padding: 25px;
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .video-card:hover {
            border-color: var(--primary);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }

        .video-card h3 {
            margin-bottom: 10px;
            font-size: 1.3em;
        }

        .video-card p {
            color: var(--text-light);
            margin-bottom: 15px;
        }

        .video-meta {
            color: var(--text-light);
            font-size: 0.9em;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        /* å¥å­ç»ƒä¹ åŒºåŸŸ */
        .practice-area {
            padding: 30px;
        }

        .sentence-card {
            background: var(--surface);
            border: 2px solid #E2E8F0;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }

        .sentence-card.active {
            border-color: var(--primary);
            background: linear-gradient(135deg, var(--primary-light) 0%, #E6F3FF 100%);
        }

        .sentence-card.completed {
            border-color: var(--success);
            background: #F0FFF4;
        }

        .sentence-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .sentence-number {
            background: var(--primary);
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        .sentence-text {
            font-size: 1.3em;
            line-height: 1.6;
            margin-bottom: 20px;
            text-align: center;
            font-weight: 500;
        }

        .sentence-actions {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-bottom: 20px;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 10px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: #0DA271;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: var(--surface);
            color: var(--text);
            border: 2px solid #E2E8F0;
        }

        .btn-secondary:hover {
            background: #F7FAFC;
        }

        .btn-recording {
            background: var(--error);
            color: white;
            animation: pulse 1.5s infinite;
        }

        /* å½•éŸ³å¯è§†åŒ– */
        .recording-visual {
            text-align: center;
            margin: 20px 0;
        }

        .waveform {
            display: flex;
            align-items: end;
            justify-content: center;
            gap: 3px;
            height: 60px;
            margin: 20px 0;
        }

        .wave-bar {
            width: 4px;
            background: var(--primary);
            border-radius: 2px;
            transition: height 0.1s ease;
        }

        .recording-timer {
            font-size: 1.5em;
            font-weight: bold;
            color: var(--primary);
            margin: 10px 0;
        }

        .recording-status {
            text-align: center;
            padding: 15px;
            margin: 15px 0;
            border-radius: 10px;
            background: #FEF3C7;
            border: 1px solid var(--warning);
            color: var(--warning);
        }

        /* è¯„åˆ†ç»“æœ */
        .score-result {
            text-align: center;
            padding: 20px;
            margin: 20px 0;
            border-radius: 15px;
            background: #E0F2FE;
            border: 1px solid #0EA5E9;
        }

        .score-number {
            font-size: 3em;
            font-weight: bold;
            margin: 10px 0;
        }

        .score-excellent {
            color: var(--success);
        }

        .score-good {
            color: var(--warning);
        }

        .score-poor {
            color: var(--error);
        }

        .feedback {
            font-size: 1.1em;
            margin: 10px 0;
        }

        .pronunciation-tips {
            background: #F8FAFC;
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            text-align: left;
        }

        .tip-item {
            display: flex;
            align-items: center;
            margin: 8px 0;
            font-size: 0.9em;
        }

        .tip-icon {
            margin-right: 10px;
            font-size: 1.2em;
        }

        /* å¯¼èˆªæŒ‰é’® */
        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
            padding: 20px;
            border-top: 1px solid #E2E8F0;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 15px;
            }
            
            .header {
                padding: 20px;
            }
            
            .practice-area, .video-library {
                padding: 20px;
            }
            
            .sentence-text {
                font-size: 1.1em;
            }
            
            .sentence-actions {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
                justify-content: center;
            }
            
            .video-meta {
                flex-direction: column;
                gap: 5px;
            }
        }
    </style>
</head>
<body>
    <div class="container" id="appContainer">
        <!-- å†…å®¹å°†é€šè¿‡JavaScriptåŠ¨æ€æ¸²æŸ“ -->
    </div>

    <script>
        // åº”ç”¨çŠ¶æ€
        let currentView = 'video-library'; // 'video-library' | 'practice'
        let currentSentenceIndex = 0;
        let isRecording = false;
        let recordingTimer = null;
        let recordingSeconds = 0;
        let waveAnimation = null;

        // ç¤ºä¾‹æ•°æ®
        const videoLibrary = [
            {
                id: 'peppa',
                title: 'ğŸ· å°çŒªä½©å¥‡ - å›½é™…æ—¥',
                description: 'é€‚åˆåˆçº§å­¦ä¹ è€…ï¼Œç®€å•å¯¹è¯ç»ƒä¹ ',
                level: 'åˆçº§',
                duration: '15åˆ†é’Ÿ',
                rating: '5.0',
                learners: '2.3k',
                sentences: [
                    {
                        text: "Hello, my name is Peppa Pig.",
                        translation: "ä½ å¥½ï¼Œæˆ‘å«å°çŒªä½©å¥‡ã€‚",
                        difficulty: "easy",
                        tips: [
                            "æ³¨æ„ 'Hello' çš„ /h/ å‘éŸ³è¦è½»",
                            "'Peppa' çš„é‡éŸ³åœ¨ç¬¬ä¸€ä¸ªéŸ³èŠ‚",
                            "'Pig' çš„ /Éª/ å‘éŸ³è¦çŸ­ä¿ƒ"
                        ]
                    },
                    {
                        text: "This is my little brother, George.",
                        translation: "è¿™æ˜¯æˆ‘çš„å¼Ÿå¼Ÿä¹”æ²»ã€‚",
                        difficulty: "medium",
                        tips: [
                            "'little' çš„ /l/ å‘éŸ³è¦æ¸…æ™°",
                            "'brother' çš„ /Ã°/ å‘éŸ³è¦æ³¨æ„",
                            "æ³¨æ„å¥å­ä¸­çš„è¿è¯»"
                        ]
                    },
                    {
                        text: "We are going to the playground today.",
                        translation: "æˆ‘ä»¬ä»Šå¤©è¦å»æ¸¸ä¹åœºã€‚",
                        difficulty: "medium",
                        tips: [
                            "'going to' å¯ä»¥è¿è¯»ä¸º 'gonna'",
                            "'playground' æ˜¯å¤åˆè¯ï¼Œæ³¨æ„é‡éŸ³",
                            "æ³¨æ„ 'today' çš„å‘éŸ³"
                        ]
                    }
                ]
            },
            {
                id: 'friends',
                title: 'ğŸ‘« è€å‹è®° - å’–å•¡å…å¯¹è¯',
                description: 'æ—¥å¸¸è‹±è¯­å¯¹è¯ç»ƒä¹ ',
                level: 'ä¸­çº§',
                duration: '25åˆ†é’Ÿ',
                rating: '4.8',
                learners: '5.1k',
                sentences: [
                    {
                        text: "How you doin'?",
                        translation: "æœ€è¿‘æ€ä¹ˆæ ·ï¼Ÿ",
                        difficulty: "easy",
                        tips: [
                            "æ³¨æ„å£è¯­åŒ–çš„ç¼©å†™",
                            "è¯­æ°”è¦è½»æ¾å‹å¥½",
                            "å°¾éŸ³ç¨å¾®ä¸Šæ‰¬"
                        ]
                    },
                    {
                        text: "We were on a break!",
                        translation: "æˆ‘ä»¬å½“æ—¶åœ¨åˆ†æ‰‹æœŸï¼",
                        difficulty: "medium",
                        tips: [
                            "è¡¨è¾¾å¼ºçƒˆæƒ…æ„Ÿ",
                            "'break' å‘éŸ³è¦æ¸…æ™°",
                            "æ³¨æ„é‡éŸ³ä½ç½®"
                        ]
                    }
                ]
            }
        ];

        // æ¸²æŸ“åº”ç”¨
        function renderApp() {
            const container = document.getElementById('appContainer');
            
            if (currentView === 'video-library') {
                container.innerHTML = renderVideoLibrary();
            } else if (currentView === 'practice') {
                container.innerHTML = renderPractice();
                // åˆå§‹åŒ–ç»ƒä¹ 
                setTimeout(() => {
                    initializePractice();
                }, 0);
            }
        }

        // æ¸²æŸ“è§†é¢‘åº“
        function renderVideoLibrary() {
            return `
                <div class="header">
                    <h1>ğŸ“š è‹±è¯­å­¦ä¹ è§†é¢‘åº“</h1>
                    <p>é€‰æ‹©è§†é¢‘å¼€å§‹è·Ÿè¯»ç»ƒä¹ </p>
                </div>
                
                <div class="video-library">
                    <div class="video-grid">
                        ${videoLibrary.map(video => `
                            <div class="video-card" onclick="startPractice('${video.id}')">
                                <h3>${video.title}</h3>
                                <p>${video.description}</p>
                                <div class="video-meta">
                                    <span>â­ ${video.rating}</span>
                                    <span>ğŸ“Š ${video.level}</span>
                                    <span>ğŸ•’ ${video.duration}</span>
                                    <span>ğŸ‘¥ ${video.learners}äººå­¦ä¹ </span>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        // æ¸²æŸ“ç»ƒä¹ é¡µé¢
        function renderPractice() {
            const currentVideo = videoLibrary.find(v => v.id === currentPracticeVideo);
            
            return `
                <div class="header">
                    <h1>ğŸ¤ è‹±è¯­è·Ÿè¯»ç»ƒä¹ </h1>
                    <p>${currentVideo ? currentVideo.title : 'è·Ÿè¯»ç»ƒä¹ '}</p>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                    <div id="progressText">0/0 å¥å®Œæˆ</div>
                </div>

                <div class="practice-area">
                    <div id="sentencesContainer">
                        <!-- å¥å­å¡ç‰‡å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                    </div>

                    <!-- å½•éŸ³å¯è§†åŒ– -->
                    <div class="recording-visual" id="recordingVisual" style="display: none;">
                        <div class="waveform" id="waveform">
                            <!-- å£°æ³¢çº¹å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                        </div>
                        <div class="recording-timer" id="recordingTimer">00:00</div>
                        <div class="recording-status">
                            â— æ­£åœ¨å½•éŸ³ä¸­... ç‚¹å‡»"ç»“æŸæœ—è¯»"å®Œæˆå½•éŸ³
                        </div>
                        <button class="btn btn-recording" id="stopRecordingBtn">
                            â¹ï¸ ç»“æŸæœ—è¯»
                        </button>
                    </div>

                    <!-- è¯„åˆ†ç»“æœ -->
                    <div class="score-result" id="scoreResult" style="display: none;">
                        <h3>ğŸ¯ å‘éŸ³è¯„åˆ†</h3>
                        <div class="score-number" id="scoreNumber">0</div>
                        <div class="feedback" id="scoreFeedback"></div>
                        
                        <div class="pronunciation-tips">
                            <h4>ğŸ’¡ å‘éŸ³å»ºè®®</h4>
                            <div id="pronunciationTips">
                                <!-- å‘éŸ³å»ºè®®å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                            </div>
                        </div>
                        
                        <button class="btn btn-primary" onclick="nextSentence()">
                            â¡ï¸ ä¸‹ä¸€å¥
                        </button>
                        <button class="btn btn-secondary" onclick="repeatSentence()" style="margin-top: 10px;">
                            ğŸ”„ é‡å¤ç»ƒä¹ æ­¤å¥
                        </button>
                    </div>
                </div>

                <div class="navigation">
                    <button class="btn btn-secondary" onclick="goBack()">
                        â† è¿”å›è§†é¢‘åº“
                    </button>
                    <button class="btn btn-primary" id="completeBtn" style="display: none;">
                        âœ… å®Œæˆç»ƒä¹ 
                    </button>
                </div>
            `;
        }

        // å¼€å§‹ç»ƒä¹ 
        let currentPracticeVideo = null;
        function startPractice(videoId) {
            currentPracticeVideo = videoId;
            currentView = 'practice';
            currentSentenceIndex = 0;
            renderApp();
        }

        // è¿”å›è§†é¢‘åº“
        function goBack() {
            if (currentView === 'practice') {
                if (confirm('ç¡®å®šè¦è¿”å›è§†é¢‘åº“å—ï¼Ÿå½“å‰è¿›åº¦å°†ä¸ä¼šä¿å­˜ã€‚')) {
                    currentView = 'video-library';
                    renderApp();
                }
            }
        }

        // åˆå§‹åŒ–ç»ƒä¹ 
        function initializePractice() {
            renderSentences();
            updateProgress();
            createWaveform();
            
            // è®¾ç½®äº‹ä»¶ç›‘å¬
            const stopRecordingBtn = document.getElementById('stopRecordingBtn');
            if (stopRecordingBtn) {
                stopRecordingBtn.addEventListener('click', stopRecording);
            }
        }

        // æ¸²æŸ“æ‰€æœ‰å¥å­
        function renderSentences() {
            const container = document.getElementById('sentencesContainer');
            const currentVideo = videoLibrary.find(v => v.id === currentPracticeVideo);
            if (!currentVideo) return;
            
            let html = '';
            
            currentVideo.sentences.forEach((sentence, index) => {
                const isActive = index === currentSentenceIndex;
                const isCompleted = index < currentSentenceIndex;
                
                html += `
                    <div class="sentence-card ${isActive ? 'active' : ''} ${isCompleted ? 'completed' : ''}" 
                         id="sentence-${index}" ${isActive ? '' : 'style="display: none;"'}>
                        <div class="sentence-header">
                            <div class="sentence-number">${index + 1}</div>
                            <div style="color: var(--text-light); font-size: 0.9em;">
                                ${getDifficultyText(sentence.difficulty)}
                            </div>
                        </div>
                        
                        <div class="sentence-text">
                            ${sentence.text}
                            <div style="font-size: 0.8em; color: var(--text-light); margin-top: 8px;">
                                ${sentence.translation}
                            </div>
                        </div>
                        
                        <div class="sentence-actions">
                            <button class="btn btn-secondary" onclick="playDemonstration(${index})">
                                ğŸ”Š AIæœ—è¯»ç¤ºèŒƒ
                            </button>
                            <button class="btn btn-primary" onclick="startRecording(${index})" id="recordBtn-${index}">
                                ğŸ¤ å¼€å§‹æœ—è¯»
                            </button>
                        </div>
                        
                        <div class="pronunciation-tips">
                            <h4>ğŸ“ å‘éŸ³è¦ç‚¹</h4>
                            ${sentence.tips.map(tip => `
                                <div class="tip-item">
                                    <span class="tip-icon">â€¢</span>
                                    <span>${tip}</span>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        // æ’­æ”¾AIæœ—è¯»ç¤ºèŒƒ
        function playDemonstration(index) {
            const currentVideo = videoLibrary.find(v => v.id === currentPracticeVideo);
            const sentence = currentVideo.sentences[index];
            alert(`AIæœ—è¯»ç¤ºèŒƒ: "${sentence.text}"\n\nåœ¨å®é™…å®Œæ•´ç‰ˆæœ¬ä¸­ï¼Œè¿™é‡Œä¼šæ’­æ”¾AIè¯­éŸ³ã€‚`);
        }

        // å¼€å§‹å½•éŸ³
        function startRecording(index) {
            if (isRecording) return;
            
            isRecording = true;
            currentSentenceIndex = index;
            
            // æ›´æ–°UI
            document.getElementById(`recordBtn-${index}`).style.display = 'none';
            document.getElementById('recordingVisual').style.display = 'block';
            
            // å¼€å§‹è®¡æ—¶
            startRecordingTimer();
            
            // å¼€å§‹å£°æ³¢çº¹åŠ¨ç”»
            startWaveAnimation();
        }

        // åœæ­¢å½•éŸ³
        function stopRecording() {
            if (!isRecording) return;
            
            isRecording = false;
            
            // åœæ­¢è®¡æ—¶å’ŒåŠ¨ç”»
            stopRecordingTimer();
            stopWaveAnimation();
            
            // éšè—å½•éŸ³ç•Œé¢
            document.getElementById('recordingVisual').style.display = 'none';
            
            // æ˜¾ç¤ºåˆ†æä¸­çš„çŠ¶æ€
            showAnalyzingState();
            
            // æ¨¡æ‹Ÿåˆ†æè¿‡ç¨‹
            setTimeout(() => {
                showScoreResult();
            }, 2000);
        }

        // å½•éŸ³è®¡æ—¶å™¨
        function startRecordingTimer() {
            recordingSeconds = 0;
            recordingTimer = setInterval(() => {
                recordingSeconds++;
                const minutes = Math.floor(recordingSeconds / 60);
                const seconds = recordingSeconds % 60;
                document.getElementById('recordingTimer').textContent = 
                    `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }, 1000);
        }

        function stopRecordingTimer() {
            if (recordingTimer) {
                clearInterval(recordingTimer);
                recordingTimer = null;
            }
        }

        // å£°æ³¢çº¹åŠ¨ç”»
        function createWaveform() {
            const waveform = document.getElementById('waveform');
            waveform.innerHTML = '';
            
            for (let i = 0; i < 50; i++) {
                const bar = document.createElement('div');
                bar.className = 'wave-bar';
                bar.style.height = '10px';
                waveform.appendChild(bar);
            }
        }

        function startWaveAnimation() {
            const bars = document.querySelectorAll('.wave-bar');
            waveAnimation = setInterval(() => {
                bars.forEach(bar => {
                    const randomHeight = Math.random() * 50 + 10;
                    bar.style.height = `${randomHeight}px`;
                    bar.style.background = `hsl(${Math.random() * 60 + 180}, 70%, 60%)`;
                });
            }, 100);
        }

        function stopWaveAnimation() {
            if (waveAnimation) {
                clearInterval(waveAnimation);
                waveAnimation = null;
            }
            
            const bars = document.querySelectorAll('.wave-bar');
            bars.forEach(bar => {
                bar.style.height = '10px';
                bar.style.background = 'var(--primary)';
            });
        }

        // æ˜¾ç¤ºåˆ†æçŠ¶æ€
        function showAnalyzingState() {
            const sentenceCard = document.getElementById(`sentence-${currentSentenceIndex}`);
            sentenceCard.innerHTML = `
                <div style="text-align: center; padding: 40px;">
                    <div class="loading" style="width: 40px; height: 40px; margin: 0 auto 20px auto;"></div>
                    <h3>æ­£åœ¨åˆ†ææ‚¨çš„å‘éŸ³...</h3>
                    <p style="color: var(--text-light);">AIæ­£åœ¨è¯„ä¼°æ‚¨çš„æœ—è¯»å‡†ç¡®æ€§</p>
                </div>
            `;
        }

        // æ˜¾ç¤ºè¯„åˆ†ç»“æœ
        function showScoreResult() {
            const currentVideo = videoLibrary.find(v => v.id === currentPracticeVideo);
            const currentSentence = currentVideo.sentences[currentSentenceIndex];
            const score = Math.floor(Math.random() * 25) + 70;
            
            // æ›´æ–°åˆ†æ•°æ˜¾ç¤º
            const scoreNumber = document.getElementById('scoreNumber');
            const scoreFeedback = document.getElementById('scoreFeedback');
            
            scoreNumber.textContent = score;
            scoreNumber.className = `score-number ${
                score >= 90 ? 'score-excellent' : 
                score >= 80 ? 'score-good' : 'score-poor'
            }`;
            
            if (score >= 90) {
                scoreFeedback.innerHTML = 'ğŸ‰ å¤ªæ£’äº†ï¼å‘éŸ³éå¸¸æ ‡å‡†ï¼';
            } else if (score >= 80) {
                scoreFeedback.innerHTML = 'ğŸ‘ å¾ˆå¥½ï¼ç»§ç»­åŠªåŠ›ï¼';
            } else {
                scoreFeedback.innerHTML = 'ğŸ’ª ä¸é”™ï¼å¤šç»ƒä¹ ä¼šæœ‰æ›´å¤§è¿›æ­¥ï¼';
            }
            
            // æ˜¾ç¤ºå‘éŸ³å»ºè®®
            const tipsHtml = currentSentence.tips.map(tip => `
                <div class="tip-item">
                    <span class="tip-icon">â€¢</span>
                    <span>${tip}</span>
                </div>
            `).join('');
            
            document.getElementById('pronunciationTips').innerHTML = tipsHtml;
            document.getElementById('scoreResult').style.display = 'block';
            updateProgress();
        }

        // ä¸‹ä¸€å¥
        function nextSentence() {
            document.getElementById('scoreResult').style.display = 'none';
            
            const currentCard = document.getElementById(`sentence-${currentSentenceIndex}`);
            currentCard.classList.remove('active');
            currentCard.classList.add('completed');
            currentCard.style.display = 'none';
            
            currentSentenceIndex++;
            
            const currentVideo = videoLibrary.find(v => v.id === currentPracticeVideo);
            if (currentSentenceIndex < currentVideo.sentences.length) {
                const nextCard = document.getElementById(`sentence-${currentSentenceIndex}`);
                nextCard.classList.add('active');
                nextCard.style.display = 'block';
                document.getElementById(`recordBtn-${currentSentenceIndex}`).style.display = 'flex';
            } else {
                showCompletion();
            }
            
            updateProgress();
        }

        // é‡å¤å½“å‰å¥å­
        function repeatSentence() {
            document.getElementById('scoreResult').style.display = 'none';
            document.getElementById(`recordBtn-${currentSentenceIndex}`).style.display = 'flex';
            
            // é‡æ–°æ¸²æŸ“å½“å‰å¥å­
            const currentCard = document.getElementById(`sentence-${currentSentenceIndex}`);
            currentCard.classList.remove('completed');
            currentCard.classList.add('active');
        }

        // æ˜¾ç¤ºå®Œæˆç•Œé¢
        function showCompletion() {
            const container = document.getElementById('sentencesContainer');
            const totalScore = Math.floor(Math.random() * 20) + 80;
            const currentVideo = videoLibrary.find(v => v.id === currentPracticeVideo);
            
            container.innerHTML = `
                <div style="text-align: center; padding: 60px 20px;">
                    <div style="font-size: 4em; margin-bottom: 20px;">ğŸ‰</div>
                    <h2>ç»ƒä¹ å®Œæˆï¼</h2>
                    <div style="font-size: 3em; font-weight: bold; color: var(--primary); margin: 20px 0;">
                        ${totalScore}åˆ†
                    </div>
                    <p style="color: var(--text-light); margin-bottom: 30px;">
                        æ‚¨å®Œæˆäº† ${currentVideo.sentences.length} å¥è·Ÿè¯»ç»ƒä¹ 
                    </p>
                    <div style="display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;">
                        <button class="btn btn-primary" onclick="restartPractice()">
                            ğŸ”„ é‡æ–°ç»ƒä¹ 
                        </button>
                        <button class="btn btn-secondary" onclick="goBack()">
                            ğŸ“š è¿”å›è§†é¢‘åº“
                        </button>
                    </div>
                </div>
            `;
            
            document.getElementById('completeBtn').style.display = 'none';
        }

        // é‡æ–°å¼€å§‹ç»ƒä¹ 
        function restartPractice() {
            currentSentenceIndex = 0;
            initializePractice();
        }

        // æ›´æ–°è¿›åº¦
        function updateProgress() {
            const currentVideo = videoLibrary.find(v => v.id === currentPracticeVideo);
            const progress = (currentSentenceIndex / currentVideo.sentences.length) * 100;
            document.getElementById('progressFill').style.width = `${progress}%`;
            document.getElementById('progressText').textContent = 
                `${currentSentenceIndex}/${currentVideo.sentences.length} å¥å®Œæˆ`;
        }

        // å·¥å…·å‡½æ•°
        function getDifficultyText(difficulty) {
            const texts = {
                'easy': 'â­ ç®€å•',
                'medium': 'â­â­ ä¸­ç­‰', 
                'hard': 'â­â­â­ å›°éš¾'
            };
            return texts[difficulty] || difficulty;
        }

        // åˆå§‹åŒ–åº”ç”¨
        document.addEventListener('DOMContentLoaded', function() {
            renderApp();
        });
    </script>
</body>
</html>
