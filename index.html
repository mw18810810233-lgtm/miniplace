<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è‹±è¯­è·Ÿè¯»ç»ƒä¹ å¹³å°</title>
    <style>
        :root {
            --primary: #10B981;
            --primary-light: #A7F3D0;
            --success: #059669;
            --warning: #F59E0B;
            --error: #EF4444;
            --background: #F0FDF4;
            --surface: #FFFFFF;
            --text: #064E3B;
            --text-light: #6B7280;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--background);
            color: var(--text);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: var(--surface);
            border-radius: 20px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.06);
            overflow: hidden;
            min-height: 600px;
        }

        .header {
            background: linear-gradient(135deg, var(--primary) 0%, #059669 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        /* è§†é¢‘åº“æ ·å¼ */
        .video-library {
            padding: 30px;
        }

        .library-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .upload-section {
            background: #F8FAFC;
            border: 2px dashed #E2E8F0;
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            margin-bottom: 30px;
            transition: all 0.3s ease;
        }

        .video-grid {
            display: grid;
            gap: 25px;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        }

        .video-card {
            border: 2px solid #E2E8F0;
            border-radius: 15px;
            overflow: hidden;
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .video-card:hover {
            border-color: var(--primary);
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .video-thumbnail {
            width: 100%;
            height: 180px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 3em;
            position: relative;
            overflow: hidden;
        }

        .video-thumbnail video {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .video-duration {
            position: absolute;
            bottom: 10px;
            right: 10px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8em;
        }

        .video-info {
            padding: 20px;
        }

        /* è§†é¢‘æ’­æ”¾å™¨æ ·å¼ - é›†æˆåœ¨åº“ä¸­ */
        .video-player-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .video-player-content {
            background: white;
            border-radius: 15px;
            width: 90%;
            max-width: 1000px;
            max-height: 90vh;
            overflow: hidden;
        }

        .video-player-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            background: var(--primary);
            color: white;
        }

        .video-player-body {
            display: flex;
            height: 600px;
        }

        .video-player-main {
            flex: 1;
            background: #000;
            position: relative;
        }

        .video-player-sidebar {
            width: 350px;
            background: #F8FAFC;
            border-left: 1px solid #E2E8F0;
            display: flex;
            flex-direction: column;
        }

        .video-player {
            width: 100%;
            height: 100%;
        }

        .practice-section {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
        }

        .subtitle-section {
            padding: 20px;
            border-top: 1px solid #E2E8F0;
            max-height: 200px;
            overflow-y: auto;
        }

        .subtitle-item {
            padding: 10px;
            margin: 5px 0;
            background: white;
            border-radius: 8px;
            border: 1px solid #E2E8F0;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .subtitle-item:hover {
            border-color: var(--primary);
            background: var(--primary-light);
        }

        .subtitle-item.active {
            border-color: var(--primary);
            background: var(--primary);
            color: white;
        }

        /* ç»ƒä¹ åŒºåŸŸæ ·å¼ */
        .sentence-card {
            background: var(--surface);
            border: 2px solid #E2E8F0;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 15px;
            transition: all 0.3s ease;
        }

        .sentence-card.active {
            border-color: var(--primary);
            background: linear-gradient(135deg, var(--primary-light) 0%, #E6F3FF 100%);
        }

        .sentence-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .sentence-number {
            background: var(--primary);
            color: white;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.9em;
        }

        .sentence-text {
            font-size: 1.1em;
            line-height: 1.5;
            margin-bottom: 15px;
            text-align: center;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-secondary {
            background: var(--surface);
            color: var(--text);
            border: 2px solid #E2E8F0;
        }

        .btn-danger {
            background: var(--error);
            color: white;
        }

        /* AIåˆ†æçŠ¶æ€ */
        .analyzing-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            color: white;
            flex-direction: column;
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 15px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .video-player-body {
                flex-direction: column;
                height: auto;
            }
            
            .video-player-sidebar {
                width: 100%;
                height: 300px;
            }
            
            .video-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container" id="appContainer">
        <!-- å†…å®¹å°†é€šè¿‡JavaScriptåŠ¨æ€æ¸²æŸ“ -->
    </div>

    <!-- è§†é¢‘æ’­æ”¾å™¨æ¨¡æ€æ¡† -->
    <div class="video-player-modal" id="videoPlayerModal">
        <div class="video-player-content">
            <div class="video-player-header">
                <h3 id="modalVideoTitle">è§†é¢‘æ’­æ”¾</h3>
                <button class="btn btn-secondary" onclick="closeVideoPlayer()" style="background: rgba(255,255,255,0.2); color: white;">
                    âœ• å…³é—­
                </button>
            </div>
            <div class="video-player-body">
                <div class="video-player-main">
                    <video class="video-player" id="mainVideoPlayer" controls playsinline>
                        æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè§†é¢‘æ’­æ”¾ã€‚
                    </video>
                    <div class="analyzing-overlay" id="analyzingOverlay">
                        <div class="loading-spinner"></div>
                        <div>AIæ­£åœ¨åˆ†æè§†é¢‘å­—å¹•...</div>
                        <div style="font-size: 0.9em; margin-top: 10px; opacity: 0.8;" id="analysisProgress">0%</div>
                    </div>
                </div>
                <div class="video-player-sidebar">
                    <div class="practice-section" id="practiceSection">
                        <h4>ğŸ¤ è·Ÿè¯»ç»ƒä¹ </h4>
                        <div id="sentencesContainer">
                            <!-- å¥å­å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                        </div>
                    </div>
                    <div class="subtitle-section">
                        <h4>ğŸ“ è¯†åˆ«å­—å¹•</h4>
                        <div id="subtitlesContainer">
                            <!-- å­—å¹•å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // åº”ç”¨çŠ¶æ€
        let currentView = 'video-library';
        let userVideos = [];
        let currentVideoElement = null;
        let currentSubtitles = [];

        // ç¤ºä¾‹é¢„è®¾è§†é¢‘æ•°æ®
        const presetVideos = [
            {
                id: 'peppa',
                title: 'ğŸ· å°çŒªä½©å¥‡ - å›½é™…æ—¥',
                description: 'é€‚åˆåˆçº§å­¦ä¹ è€…ï¼Œç®€å•å¯¹è¯ç»ƒä¹ ',
                level: 'åˆçº§',
                duration: '2:30',
                rating: '5.0',
                learners: '2.3k',
                type: 'preset',
                thumbnail: 'ğŸ·',
                sentences: [
                    {
                        text: "Hello, my name is Peppa Pig.",
                        translation: "ä½ å¥½ï¼Œæˆ‘å«å°çŒªä½©å¥‡ã€‚",
                        difficulty: "easy",
                        startTime: 0,
                        endTime: 3
                    },
                    {
                        text: "This is my little brother, George.",
                        translation: "è¿™æ˜¯æˆ‘çš„å¼Ÿå¼Ÿä¹”æ²»ã€‚",
                        difficulty: "medium",
                        startTime: 3,
                        endTime: 6
                    }
                ]
            }
        ];

        // æ¸²æŸ“åº”ç”¨
        function renderApp() {
            const container = document.getElementById('appContainer');
            
            if (currentView === 'video-library') {
                container.innerHTML = renderVideoLibrary();
            }
        }

        // æ¸²æŸ“è§†é¢‘åº“
        function renderVideoLibrary() {
            const allVideos = [...presetVideos, ...userVideos];
            
            return `
                <div class="header">
                    <h1>ğŸ¬ è‹±è¯­å­¦ä¹ è§†é¢‘åº“</h1>
                    <p>ä¸Šä¼ è§†é¢‘æˆ–é€‰æ‹©é¢„è®¾å†…å®¹å¼€å§‹è·Ÿè¯»ç»ƒä¹ </p>
                </div>
                
                <div class="video-library">
                    <div class="library-header">
                        <h2>æˆ‘çš„è§†é¢‘åº“</h2>
                        <button class="btn btn-primary" onclick="showUploadSection()">
                            ğŸ“ ä¸Šä¼ æ–°è§†é¢‘
                        </button>
                    </div>

                    <div class="upload-section" id="uploadSection" style="display: none;">
                        <div class="upload-area" onclick="document.getElementById('fileInput').click()">
                            <div style="font-size: 3em; margin-bottom: 15px;">ğŸ“¤</div>
                            <h3 style="margin-bottom: 20px;">ç‚¹å‡»é€‰æ‹©è§†é¢‘æ–‡ä»¶æˆ–æ‹–æ‹½åˆ°æ­¤åŒºåŸŸ</h3>
                            <p style="color: var(--text-light); margin-bottom: 20px;">
                                æ”¯æŒ MP4, WebM, MOV æ ¼å¼
                            </p>
                            <button class="btn btn-secondary">
                                ğŸ“ é€‰æ‹©è§†é¢‘æ–‡ä»¶
                            </button>
                        </div>
                        <input type="file" id="fileInput" class="file-input" accept="video/*" onchange="handleFileUpload(this.files)">
                    </div>

                    ${userVideos.length > 0 ? `
                        <h3 style="margin: 30px 0 20px 0;">æˆ‘çš„ä¸Šä¼ </h3>
                        <div class="video-grid">
                            ${userVideos.map(video => renderVideoCard(video)).join('')}
                        </div>
                    ` : ''}

                    <h3 style="margin: 30px 0 20px 0;">é¢„è®¾å­¦ä¹ å†…å®¹</h3>
                    <div class="video-grid">
                        ${presetVideos.map(video => renderVideoCard(video)).join('')}
                    </div>
                </div>
            `;
        }

        // æ¸²æŸ“è§†é¢‘å¡ç‰‡
        function renderVideoCard(video) {
            const thumbnailContent = video.type === 'user' && video.objectUrl ? 
                `<video muted playsinline>
                    <source src="${video.objectUrl}" type="${video.file.type}">
                </video>` : 
                `<div>${video.thumbnail}</div>`;
            
            return `
                <div class="video-card" onclick="openVideoPlayer('${video.id}')">
                    <div class="video-thumbnail">
                        ${thumbnailContent}
                        <div class="video-duration">${video.duration}</div>
                    </div>
                    <div class="video-info">
                        <h3>${video.title}</h3>
                        <p>${video.description}</p>
                        <div style="color: var(--text-light); font-size: 0.8em; display: flex; justify-content: space-between; align-items: center;">
                            <span>â­ ${video.rating}</span>
                            <span>ğŸ“Š ${video.level}</span>
                            <span>ğŸ‘¥ ${video.learners}</span>
                        </div>
                        ${video.type === 'user' ? `
                            <div style="margin-top: 10px;">
                                <button class="btn btn-danger" onclick="event.stopPropagation(); deleteVideo('${video.id}')" style="padding: 6px 12px; font-size: 12px;">
                                    ğŸ—‘ï¸ åˆ é™¤
                                </button>
                            </div>
                        ` : ''}
                    </div>
                </div>
            `;
        }

        // æ‰“å¼€è§†é¢‘æ’­æ”¾å™¨ï¼ˆæ¨¡æ€æ¡†æ–¹å¼ï¼‰
        function openVideoPlayer(videoId) {
            const video = getVideoById(videoId);
            if (!video) return;

            const modal = document.getElementById('videoPlayerModal');
            const videoTitle = document.getElementById('modalVideoTitle');
            const videoPlayer = document.getElementById('mainVideoPlayer');

            videoTitle.textContent = video.title;
            
            // è®¾ç½®è§†é¢‘æº
            const videoSource = video.objectUrl || video.videoUrl;
            videoPlayer.innerHTML = `<source src="${videoSource}" type="video/mp4">`;
            videoPlayer.load();

            // æ˜¾ç¤ºæ¨¡æ€æ¡†
            modal.style.display = 'flex';
            
            // åˆå§‹åŒ–æ’­æ”¾å™¨
            currentVideoElement = videoPlayer;
            initializeVideoPlayer(video);
        }

        // å…³é—­è§†é¢‘æ’­æ”¾å™¨
        function closeVideoPlayer() {
            const modal = document.getElementById('videoPlayerModal');
            modal.style.display = 'none';
            
            if (currentVideoElement) {
                currentVideoElement.pause();
            }
        }

        // åˆå§‹åŒ–è§†é¢‘æ’­æ”¾å™¨
        function initializeVideoPlayer(video) {
            const videoPlayer = document.getElementById('mainVideoPlayer');
            
            // å¦‚æœæœ‰é¢„è®¾å¥å­ï¼Œç›´æ¥ä½¿ç”¨
            if (video.sentences && video.sentences.length > 0) {
                renderSentences(video.sentences);
                renderSubtitles(video.sentences);
            } else {
                // å¦åˆ™å¯åŠ¨AIå­—å¹•åˆ†æ
                startAISubtitleAnalysis(video);
            }

            // æ·»åŠ æ—¶é—´æ›´æ–°ç›‘å¬å™¨ï¼Œç”¨äºé«˜äº®å½“å‰å¥å­
            videoPlayer.addEventListener('timeupdate', function() {
                updateCurrentSentence(this.currentTime);
            });
        }

        // AIå­—å¹•åˆ†æ
        function startAISubtitleAnalysis(video) {
            const overlay = document.getElementById('analyzingOverlay');
            const progressText = document.getElementById('analysisProgress');
            
            // æ˜¾ç¤ºåˆ†æç•Œé¢
            overlay.style.display = 'flex';
            
            let progress = 0;
            const interval = setInterval(() => {
                progress += Math.random() * 15;
                if (progress >= 100) {
                    progress = 100;
                    clearInterval(interval);
                    
                    // æ¨¡æ‹ŸAIåˆ†æå®Œæˆ
                    setTimeout(() => {
                        overlay.style.display = 'none';
                        const generatedSentences = generateAISubtitles(video);
                        video.sentences = generatedSentences;
                        renderSentences(generatedSentences);
                        renderSubtitles(generatedSentences);
                    }, 500);
                }
                progressText.textContent = Math.round(progress) + '%';
            }, 200);
        }

        // æ¨¡æ‹ŸAIç”Ÿæˆå­—å¹•ï¼ˆå®é™…åº”ç”¨ä¸­ä¼šè°ƒç”¨çœŸå®çš„è¯­éŸ³è¯†åˆ«APIï¼‰
        function generateAISubtitles(video) {
            // è¿™é‡Œæ¨¡æ‹ŸAIåˆ†æå‡ºçš„å¥å­
            return [
                {
                    text: "Hello everyone, welcome to our English class.",
                    translation: "å¤§å®¶å¥½ï¼Œæ¬¢è¿æ¥åˆ°æˆ‘ä»¬çš„è‹±è¯­è¯¾å ‚ã€‚",
                    difficulty: "easy",
                    startTime: 0,
                    endTime: 4
                },
                {
                    text: "Today we are going to learn about daily conversations.",
                    translation: "ä»Šå¤©æˆ‘ä»¬å°†å­¦ä¹ æ—¥å¸¸å¯¹è¯ã€‚",
                    difficulty: "medium",
                    startTime: 4,
                    endTime: 8
                },
                {
                    text: "Let's practice some useful phrases together.",
                    translation: "è®©æˆ‘ä»¬ä¸€èµ·ç»ƒä¹ ä¸€äº›æœ‰ç”¨çš„çŸ­è¯­ã€‚",
                    difficulty: "medium",
                    startTime: 8,
                    endTime: 12
                },
                {
                    text: "Repeat after me and pay attention to your pronunciation.",
                    translation: "è·Ÿæˆ‘é‡å¤ï¼Œæ³¨æ„ä½ çš„å‘éŸ³ã€‚",
                    difficulty: "medium",
                    startTime: 12,
                    endTime: 16
                },
                {
                    text: "Great job! Keep practicing and you will improve quickly.",
                    translation: "åšå¾—å¾ˆå¥½ï¼ç»§ç»­ç»ƒä¹ ï¼Œä½ ä¼šå¾ˆå¿«è¿›æ­¥çš„ã€‚",
                    difficulty: "hard",
                    startTime: 16,
                    endTime: 20
                }
            ];
        }

        // æ¸²æŸ“å¥å­
        function renderSentences(sentences) {
            const container = document.getElementById('sentencesContainer');
            let html = sentences.map((sentence, index) => `
                <div class="sentence-card" id="sentence-${index}" onclick="playSentence(${index})">
                    <div class="sentence-header">
                        <div class="sentence-number">${index + 1}</div>
                        <div style="color: var(--text-light); font-size: 0.8em;">
                            ${sentence.difficulty === 'easy' ? 'â­ ç®€å•' : sentence.difficulty === 'medium' ? 'â­â­ ä¸­ç­‰' : 'â­â­â­ å›°éš¾'}
                        </div>
                    </div>
                    <div class="sentence-text">
                        ${sentence.text}
                        <div style="font-size: 0.8em; color: var(--text-light); margin-top: 8px;">
                            ${sentence.translation}
                        </div>
                    </div>
                    <div style="display: flex; gap: 8px; margin-top: 10px;">
                        <button class="btn btn-secondary" onclick="event.stopPropagation(); playDemonstration(${index})" style="padding: 6px 12px; font-size: 12px;">
                            ğŸ”Š ç¤ºèŒƒ
                        </button>
                        <button class="btn btn-primary" onclick="event.stopPropagation(); startRecording(${index})" style="padding: 6px 12px; font-size: 12px;">
                            ğŸ¤ è·Ÿè¯»
                        </button>
                    </div>
                </div>
            `).join('');
            container.innerHTML = html;
        }

        // æ¸²æŸ“å­—å¹•
        function renderSubtitles(sentences) {
            const container = document.getElementById('subtitlesContainer');
            let html = sentences.map((sentence, index) => `
                <div class="subtitle-item" id="subtitle-${index}" onclick="playSentence(${index})">
                    <div style="font-weight: 500;">${sentence.text}</div>
                    <div style="font-size: 0.8em; color: var(--text-light); margin-top: 4px;">
                        ${formatTime(sentence.startTime)} - ${formatTime(sentence.endTime)}
                    </div>
                </div>
            `).join('');
            container.innerHTML = html;
        }

        // æ’­æ”¾æŒ‡å®šå¥å­å¯¹åº”çš„æ—¶é—´æ®µ
        function playSentence(index) {
            if (!currentVideoElement) return;
            
            const sentences = getCurrentVideo().sentences;
            const sentence = sentences[index];
            
            // è·³è½¬åˆ°å¥å­å¼€å§‹æ—¶é—´
            currentVideoElement.currentTime = sentence.startTime;
            currentVideoElement.play();
            
            // é«˜äº®å½“å‰å¥å­å’Œå­—å¹•
            highlightCurrentItem(index);
        }

        // é«˜äº®å½“å‰é¡¹ç›®
        function highlightCurrentItem(index) {
            // ç§»é™¤æ‰€æœ‰é«˜äº®
            document.querySelectorAll('.sentence-card').forEach(card => {
                card.classList.remove('active');
            });
            document.querySelectorAll('.subtitle-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // æ·»åŠ å½“å‰é«˜äº®
            const sentenceCard = document.getElementById(`sentence-${index}`);
            const subtitleItem = document.getElementById(`subtitle-${index}`);
            
            if (sentenceCard) sentenceCard.classList.add('active');
            if (subtitleItem) subtitleItem.classList.add('active');
        }

        // æ›´æ–°æ—¶é—´è½´é«˜äº®
        function updateCurrentSentence(currentTime) {
            const sentences = getCurrentVideo().sentences;
            if (!sentences) return;
            
            let currentIndex = -1;
            sentences.forEach((sentence, index) => {
                if (currentTime >= sentence.startTime && currentTime <= sentence.endTime) {
                    currentIndex = index;
                }
            });
            
            if (currentIndex !== -1) {
                highlightCurrentItem(currentIndex);
            }
        }

        // å·¥å…·å‡½æ•°
        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = Math.floor(seconds % 60);
            return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
        }

        function getVideoById(videoId) {
            const allVideos = [...presetVideos, ...userVideos];
            return allVideos.find(video => video.id === videoId);
        }

        function getCurrentVideo() {
            const videoTitle = document.getElementById('modalVideoTitle').textContent;
            const allVideos = [...presetVideos, ...userVideos];
            return allVideos.find(video => video.title === videoTitle);
        }

        // è§†é¢‘ç®¡ç†åŠŸèƒ½
        function showUploadSection() {
            const uploadSection = document.getElementById('uploadSection');
            uploadSection.style.display = uploadSection.style.display === 'none' ? 'block' : 'none';
        }

        function handleFileUpload(files) {
            if (files.length === 0) return;
            
            const file = files[0];
            if (!file.type.startsWith('video/')) {
                alert('è¯·é€‰æ‹©è§†é¢‘æ–‡ä»¶ï¼');
                return;
            }

            // åˆ›å»ºå¯¹è±¡URLç”¨äºæœ¬åœ°æ’­æ”¾
            const objectUrl = URL.createObjectURL(file);
            
            // åˆ›å»ºæ–°è§†é¢‘å¯¹è±¡
            const newVideo = {
                id: 'user_' + Date.now(),
                title: file.name.replace(/\.[^/.]+$/, ""),
                description: 'æˆ‘ä¸Šä¼ çš„å­¦ä¹ è§†é¢‘',
                level: 'è‡ªå®šä¹‰',
                duration: '--:--',
                rating: '5.0',
                learners: '1',
                type: 'user',
                thumbnail: 'ğŸ¥',
                objectUrl: objectUrl,
                file: file
                // sentences å°†åœ¨AIåˆ†ææ—¶ç”Ÿæˆ
            };
            
            userVideos.push(newVideo);
            renderApp();
            alert('è§†é¢‘ä¸Šä¼ æˆåŠŸï¼ç‚¹å‡»è§†é¢‘å¼€å§‹AIå­—å¹•åˆ†æå’Œè·Ÿè¯»ç»ƒä¹ ã€‚');
        }

        function deleteVideo(videoId) {
            if (confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªè§†é¢‘å—ï¼Ÿ')) {
                const videoIndex = userVideos.findIndex(video => video.id === videoId);
                if (videoIndex !== -1) {
                    if (userVideos[videoIndex].objectUrl) {
                        URL.revokeObjectURL(userVideos[videoIndex].objectUrl);
                    }
                    userVideos.splice(videoIndex, 1);
                }
                renderApp();
            }
        }

        // ç»ƒä¹ åŠŸèƒ½ï¼ˆç®€åŒ–ç‰ˆï¼‰
        function playDemonstration(index) {
            const video = getCurrentVideo();
            alert(`AIæœ—è¯»ç¤ºèŒƒ: "${video.sentences[index].text}"`);
        }

        function startRecording(index) {
            alert(`å¼€å§‹å½•åˆ¶ç¬¬ ${index + 1} å¥: "${getCurrentVideo().sentences[index].text}"`);
            // å®é™…å®ç°éœ€è¦è°ƒç”¨Web Audio APIè¿›è¡Œå½•éŸ³
        }

        // åˆå§‹åŒ–åº”ç”¨
        document.addEventListener('DOMContentLoaded', renderApp);

        // ç‚¹å‡»æ¨¡æ€æ¡†å¤–éƒ¨å…³é—­
        document.getElementById('videoPlayerModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeVideoPlayer();
            }
        });
    </script>
</body>
</html>
